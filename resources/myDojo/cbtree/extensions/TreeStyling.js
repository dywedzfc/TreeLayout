//>>built
define("cbtree/extensions/TreeStyling",["module","dojo/_base/lang","dojo/aspect","dojo/dom-class","dojo/dom-prop","dojo/dom-style","dijit/Tree","../errors/createError!../errors/CBTErrors.json"],function(_1,_2,_3,_4,_5,_6,_7,_8){var _9=_8(_1.id);var _a="*";var _b="__DEFAULT";function _c(o){for(var _d in o){if(o.hasOwnProperty(_d)){return false;}}return true;};function _e(_f){return (_f&&Object.prototype.toString.call(_f)=="[object Object]");};_7._TreeNode.extend({_applyClassAndStyle:function(_10,_11){var _12,_13,_14,_15,_16,_17;_15=_11+"Class";_16=_11+"Style";_17=_11+"Node";_12=_5.get(this[_17],"className");_13=(this.tree.get(_15,this.item,this.isExpanded,this)||_12);if(_12!==_13){_4.replace(this[_17],_13,_12||"");this[_15]=_13;}if(_c(this[_16])){_14=this.tree.get(_16,this.item,this.isExpanded)||{};}else{_14=this[_16];}_6.set(this[_17],_14);this[_16]=_14;},_set_icon_Attr:function(_18){if(_18.iconClass){this._set_iconClass_Attr(_18.iconClass);this.icon=_18;}},_set_iconClass_Attr:function(_19){if(_19&&(_19!==this.iconClass)){_4.replace(this.iconNode,_19,this.iconClass||"");this._applyClassAndStyle(this.item,"icon");}},_set_styling_Attr:function(_1a){this._updateItemClasses(this.item);},_setIconStyleAttr:function(_1b){this.iconStyle=_1b;this._applyClassAndStyle(this.item,"icon");},_setLabelStyleAttr:function(_1c){this.labelStyle=_1c;this._applyClassAndStyle(this.item,"label");},_setRowStyleAttr:function(_1d){this.rowStyle=_1d;this._applyClassAndStyle(this.item,"row");}});_7.extend({_hasStyling:true,_icon:null,_iconAttr:null,_itemStyleMap:{},_itemAttr:["icon","label","row"],_typeAttr:["Class","Style"],_dijitIconClasses:["dijitFolderOpened","dijitFolderClosed","dijitLeaf"],iconClass:"",_getBaseClass:function(_1e){var _1f=_1e?_5.get(_1e["iconNode"],"className"):"";var _20,_21,i;var _22="";_20=_2.trim(_1f).split(/\s+/);if(_20[0]){for(i=0;i<this._dijitIconClasses.length;i++){_21=_20.indexOf(this._dijitIconClasses[i]);if(_21!=-1){_20.splice(_21,1);}}_22=_20.toString();}return _22.replace(/,/g," ");},_getClassOrStyle:function(_23,_24,_25){var _26=_24+_25;if((this._itemAttr.indexOf(_24)!=-1)&&(this._typeAttr.indexOf(_25)!=-1)){var _27=this._getItemStyling(_23);return _27[_24][_24+_25];}throw new _9("InvalidProperty","getClassOrStyle");},_getHasTreeSytlingAttr:function(){return this._hasStyling;},_getItemStyling:function(_28){if(!this._connected){this._connectModel();}if(_2.isObject(_28)){var _29=_28?this.model.getIdentity(_28):_b;var _2a=this._itemStyleMap[_29];if(!_2a){_2a=this._getTreeStyling();if(this._icon){_2a.icon=this._icon;}this._itemStyleMap[_29]=_2a;}return _2a;}throw new _9("InvalidType","getItemStyling");},_getTreeStyling:function(){var _2b=this._itemStyleMap[_b]||{};if(_c(_2b)){this._itemAttr.forEach(function(_2c){_2b[_2c]=this._initStyleElement(_2c);},this);_2b.defStyle=true;}return _2.clone(_2b);},_initStyleElement:function(_2d){var _2e={},_2f;this._typeAttr.forEach(function(_30){_2e[_2d+_30]=null;},this);return _2e;},_setAllItems:function(_31,_32,_33,_34){var _35=(_31?(_31 instanceof Array?_31:this._object2Array(_31)):[]);var _36;_35.unshift(null);for(_36 in this._itemStyleMap){_35[0]=this._itemStyleMap[_36];_32.apply((_34||this),Array.prototype.slice.call(_35,0));}if(_33){_33.apply((_34||this),Array.prototype.slice.call(_35,1));}},_setAttrClass:function(_37,_38,_39,_3a){if(typeof _39==="string"){if(this._itemAttr.indexOf(_38)!=-1){var _3b=_2.trim(_39).split(/\s+/);if(_3b[0]){if(_37){var _3c=this._getItemStyling(_37);_3c[_38][_38+"Class"]=_39;_3c[_38]["baseClass"]=_3b[0];delete _3c.defStyle;if(_3a){_3a.call(this,_37,_38,_39,_3b[0]);}return _3c[_38];}else{this._setAllItems([_38,_39,_3b[0]],function(_3d,_3e,_3f,_40){_3d[_3e][_3e+"Class"]=_3f;_3d[_3e]["baseClass"]=_40;delete _3d.defStyle;},_3a,this);}}return null;}throw new _9("InvalidProperty","setItemClass");}throw new _9("InavlidType","setItemClass");},_setAttrClassSet:function(_41,_42,_43){if(_41){this._setAttrClass(_41,_42,_43,function(_44,_45,_46,_47){this._setStyling(_44,"_styling_",_46);});}else{this._setAttrClass(null,_42,_43,function(_48,_49,_4a){this._setTreeNodes(this.rootNode,{_styling_:_49});});}},_setAttrStyle:function(_4b,_4c,_4d,_4e){if(_2.isObject(_4d)){if(this._itemAttr.indexOf(_4c)!=-1){if(_4b){var _4f=this._getItemStyling(_4b);_4f[_4c][_4c+"Style"]=_4d;if(_4e){_4e.call(this,_4b,_4c,_4d);}return _4f[_4c];}else{this._setAllItems([_4c,_4d],function(_50,_51,_52){_50[_51][_51+"Style"]=_52;},_4e,this);}return null;}throw new _9("InvalidProperty","setItemStyle");}throw new _9("InvalidType","setItemStyle");},_setAttrStyleSet:function(_53,_54,_55){var _56={};if(!this._connected){this._connectModel();}if(_53){this._setAttrStyle(_53,_54,_55,function(_57,_58,_59){this._setStyling(_57,_58+"Style",_59);});}else{this._setAttrStyle(null,_54,_55,function(_5a,_5b){_56[_5a+"Style"]=_5b;this._setTreeNodes(this.rootNode,_56);});}},_setStyling:function(_5c,_5d,_5e){var _5f=this.model.getIdentity(_5c),_60=this._itemNodesMap[_5f],_61={};if(_60){_61[_5d]=_5e;_60.forEach(function(_62){_62.set(_61);},this);}},_getIconAttr:function(_63){var _64=this._getItemStyling(_63);if(_64.defStyle&&this._iconAttr){var _65=this.model.getIcon(_63);if(_65){_65=this._setIconAttr(_65,_63);return _65;}}else{return _64.icon;}},_getIconClassAttr:function(_66,_67,_68){return this.getIconClass(_66,_67,_68);},_getIconStyleAttr:function(_69,_6a){return this.getIconStyle(_69,_6a);},_getLabelClassAttr:function(_6b,_6c,_6d){return this.getLabelClass(_6b,_6c,_6d);},_getLabelStyleAttr:function(_6e,_6f){return this.getLabelStyle(_6e,_6f);},_getRowClassAttr:function(_70,_71,_72){return this.getRowClass(_70,_71,_72);},_getRowStyleAttr:function(_73,_74){return this.getRowStyle(_73,_74);},_setIconAttr:function(_75,_76){var _77=this._icon2Object(_75);if(_77){if(_76){var _78=this._getItemStyling(_76);_78.icon=_77;delete _78.defStyle;this._setStyling(_76,"_icon_",_77);}else{this._setAllItems([_77],function(_79,_7a){_79.icon=_7a;delete _79.defStyle;},function(_7b){this._setTreeNodes(this.rootNode,{_icon_:_7b});},this);this._icon=_77;}}return _77;},_setIconClassAttr:function(_7c,_7d){return this._setAttrClassSet(_7d,"icon",_7c);},_setIconStyleAttr:function(_7e,_7f){return this._setAttrStyleSet(_7f,"icon",_7e);},_setLabelClassAttr:function(_80,_81){return this._setAttrClassSet(_81,"label",_80);},_setLabelStyleAttr:function(_82,_83){return this._setAttrStyleSet(_83,"label",_82);},_setRowClassAttr:function(_84,_85){return this._setAttrClassSet(_85,"row",_84);},_setRowStyleAttr:function(_86,_87){return this._setAttrStyleSet(_87,"row",_86);},_setValueToIconMapAttr:function(map){if(_e(map)){var _88,_89,_8a={};for(_88 in map){if(_e(map[_88])){_8a=map[_88];if(!_c(_8a)){for(_89 in _8a){if(_8a[_89]==_a){_8a[_89]=null;}}}else{_8a[_a]=null;map[_88]=_8a;}}else{if(map[_88] instanceof Array){if(map[_88].length){map[_88].forEach(function(_8b){_8a[_8b]=_8b;},this);map[_88]=_8a;}else{_8a[_a]=null;map[_88]=_8a;}}else{if(map[_88]!="*"){throw new _9("InvalidType","_setValueToIconMap","invalid property value type");}}}}}else{map=null;}this._valueToIconMap=map;return map;},_modelIconUpdate:function(_8c,_8d,_8e){var _8f=this._getItemStyling(_8c);var _90=this._icon2Object(_8e);if(_90){_8f.icon=_90;delete _8f.defStyle;}return _90;},_valueToIcon:function(_91){if(_91&&this._valueToIconMap){var _92,_93,val,_94;for(_92 in this._valueToIconMap){_93=this._valueToIconMap[_92];if((val=_2.getObject(_92,false,_91))){if(val in _93){_94=_93[val]||val;}else{if(_a in _93){_94=_93[_a]||val;}}if(_94){switch(typeof _94){case "string":case "object":break;case "function":_94=_94.call(this,_91,_92,val);if(_94&&(!_e(_94)&&typeof _94!="string")){throw new _9("InvalidResponse","_valueToIcon");}break;default:_94=null;}if(_94){_94=this._icon2Object(_94);_94=this._wcToValue(_94,val);return _94;}}}}}},_wcToValue:function(obj,_95){if(!_e(obj)){if(obj&&typeof obj.replace=="function"){return obj.replace(/\*/g,_95);}return obj;}var key,_96=obj.constructor();for(key in obj){_96[key]=this._wcToValue(obj[key],_95);}return _96;},getIconClass:function(_97,_98,_99){var _9a,_9b,_9c=_97;var _9d,_9e,_9f,_a0;if(!_9c){if(this.rootNode){_9c=this.rootNode.item;_99=this.rootNode;_98=this.rootNode.isExpanded;}}_9a=_9c?this.model.mayHaveChildren(_9c):false;if(this._valueToIconMap){_9b=this._valueToIcon(_9c);}if(!_9b||!_9b.iconClass){_9b=this._getItemStyling(_9c)["icon"];}if(!_9b||!_9b.iconClass){_9f=(!_9c||_9a)?(_98?"dijitFolderOpened":"dijitFolderClosed"):"dijitLeaf";_9e=this._getBaseClass(_99);_9d=_9e?_9e+" "+_9f:_9f;return _9d;}_9d=_9b.iconClass;_9e=_9b.baseClass;_a0=_9b.indent;if(!_9b.fixed){if(_99){_9f=_9e+(_9a?(_98?"Expanded":"Collapsed"):"Terminal");if(_a0!==undefined&&_a0!==false){if(_a0===true||_a0>=_99.indent){_9f+=" "+_9f+"_"+_99.indent;}}_9d+=" "+_9f;}}else{_9d+=" "+_9b.fixed;}return _9d;},getIconStyle:function(_a1,_a2){var _a3=this._getClassOrStyle(_a1,"icon","Style");var _a4=this._valueToIconMap?this._valueToIcon(_a1):null;_a3=(_a4&&_a4.iconStyle)||_a3;return _a3;},getLabelClass:function(_a5,_a6){return this._getClassOrStyle(_a5,"label","Class");},getLabelStyle:function(_a7,_a8){return this._getClassOrStyle(_a7,"label","Style");},getRowClass:function(_a9,_aa){return this._getClassOrStyle(_a9,"row","Class");},getRowStyle:function(_ab,_ac){return this._getClassOrStyle(_ab,"row","Style");},get:function(_ad){var _ae=this._getAttrNames(_ad),_af=this[_ae.g];if(typeof _af==="function"){var _b0=_af.apply(this,Array.prototype.slice.call(arguments,1));return _b0;}return this[_ad];},_connectModel:function(){var _b1=this.model;this._connected=true;this._itemStyleMap={};this._getItemStyling(null);if(_b1){if(_b1.iconAttr){if(!_b1.getIcon||typeof _b1.getIcon!="function"){console.warn(new _9("MethodMissing","_connectModel","model property 'iconAttr' set but method getIcon() is missing."));this._iconAttr=null;}else{this._iconAttr=this.model.iconAttr;}}if(this.mapEventToAttr&&typeof this.mapEventToAttr==="function"){this.mapEventToAttr(null,this._iconAttr,"_icon_",this._modelIconUpdate);}_3.after(this.model,"onDelete",_2.hitch(this,"_onStyleDelete"),true);}},_icon2Object:function(_b2){var _b3,_b4,_b5;if(_b2){if(!_e(_b2)){if(typeof _b2==="string"&&_b2.length){_b4=_2.trim(_b2).split(/\s+/);if(_b4[0]){_b5=this._initStyleElement("icon");_b5.baseClass=_b4[0];_b5.iconClass=_b2;_b5.indent=true;return _b5;}}else{throw new _9("InvalidType","_icon2Object","icon must be an object or string");}}else{if(_b2.iconClass){_b4=_2.trim(_b2.iconClass).split(/\s+/);if(_b4[0]){_b5=this._initStyleElement("icon");_b5.baseClass=_b4[0];_b5.indent=true;for(_b3 in _b2){_b5[_b3]=_b2[_b3];}return _b5;}}throw new _9("ParameterMissing","_icon2Object","required property 'iconClass' is missing or empty");}}return null;},_object2Array:function(_b6){var _b7=[],_b8;if(!(_b6 instanceof Array)){if(_2.isObject(_b6)){for(_b8 in _b6){_b7.push(_b6[_b8]);}}else{_b7.push(_b6);}return _b7;}return _b6;},_onStyleDelete:function(_b9){var _ba=this.model.getIdentity(_b9);delete this._itemStyleMap[_ba];},_setTreeNodes:function(_bb,_bc){if(_bb){if(_2.isObject(_bc)){_bb.set(_bc);_bb.getChildren().forEach(function(_bd){this._setTreeNodes(_bd,_bc);},this);}}}});});