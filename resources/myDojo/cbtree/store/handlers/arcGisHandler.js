//>>built
define("cbtree/store/handlers/arcGisHandler",["dojo/_base/lang","../../util/QueryEngine","../../util/shim/Array"],function(_1,_2){"use strict";function _3(_4){return _4.replace(/(^|\W)([a-z])/g,function($0){return $0.toUpperCase();});};function _5(_6,_7){var _8=_6.split(".");var p,i=0;while(_7&&(p=_8[i++])){_7=(p in _7?_7[p]:undefined);}return _7;};function _9(_a){var _b=this;this._query=function(d){return d;};this.template=null;this.symbol=null;this.type="POI";this._querySetter=function(_c,_d){this._query=_2(_c,_d);};this.handler=function(_e){var _f=_e?(_e.text||_e.data):null;var _10=[];if(_f){var _11=_b._query(_f.results);var _12=_3(_f.value);var _13=_12.toLowerCase();if(_11&&_11.length){var _14=_5("feature.attributes.Addr_Type",_11[0]);var _15={attributes:{Addr_Type:_14||_b.type}};_10.push({id:_13,name:_12,parent:null,type:"parent",features:_15});_11.forEach(function(_16){var _17=_1.clone(_16);_17.feature.attributes.name=_16.name;_17.feature.setInfoTemplate(_b.template);_17.feature.setSymbol(_b.symbol);_17.parent=_13;_17.type="child";_10.push(_17);});}}return _10;};this.set=function(_18,_19){if(_18){if(typeof _18=="object"){for(var key in _18){this.set(key,_18[key]);}}var _1a=this["_"+_18+"Setter"];if(typeof _1a=="function"){_1a.apply(this,Array.prototype.slice.call(arguments,1));}else{this[_18]=_19;}}};if(_a){this.set(_a);}};return _9;});