//>>built
define("dgrid/ColumnSet",["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/on","dojo/aspect","dojo/query","dojo/has","./util/misc","dojo/_base/sniff"],function(_1,_2,_3,on,_4,_5,_6,_7){_6.add("event-mousewheel",function(_8,_9,_a){return "onmousewheel" in _a;});_6.add("event-wheel",function(_b,_c,_d){return "onwheel" in _d;});var _e="data-dgrid-column-set-id";function _f(_10,row){var _11=_10._columnSetScrollLefts;_5(".dgrid-column-set",row).forEach(function(_12){_12.scrollLeft=_11[_12.getAttribute(_e)];});};function _13(_14,_15){if(!_14||!_14.length){return;}var _16=[];var _17=_15+"-";for(var i=0,_18=_14.length;i<_18;i++){var row=_14[i];var _19=[];_19.className=row.className;for(var k=0,_1a=row.length;k<_1a;k++){var _1b=row[k];if(_1b.id!=null&&_1b.id.indexOf(_17)===0){_19.push(_1b);}}_16.push(_19);}return _16;};function _1c(_1d,_1e){if(_1d.nodeType!==1){_1d=_1d.parentNode;}while(_1d&&!_5.matches(_1d,".dgrid-column-set["+_e+"]",_1e)){_1d=_1d.parentNode;}return _1d;};var _1f={start:"down",end:"up"};function _20(_21){var _22=_6("pointer");if(_22){_21=_1f[_21]||_21;if(_22.slice(0,2)==="MS"){return "MSPointer"+_21.slice(0,1).toUpperCase()+_21.slice(1);}else{return "pointer"+_21;}}return "touch"+_21;};var _23=_6("touch")&&function(_24){return function(_25,_26){var _27=[on(_25,_20("start"),function(_28){if(!_24._currentlyTouchedColumnSet){var _29=_1c(_28.target,_25);if(_29&&(!_28.pointerType||_28.pointerType==="touch"||_28.pointerType===2)){_24._currentlyTouchedColumnSet=_29;_24._lastColumnSetTouchX=_28.clientX;_24._lastColumnSetTouchY=_28.clientY;}}}),on(_25,_20("move"),function(_2a){if(_24._currentlyTouchedColumnSet===null){return;}var _2b=_1c(_2a.target);if(!_2b){return;}_26.call(null,_24,_2b,_24._lastColumnSetTouchX-_2a.clientX);_24._lastColumnSetTouchX=_2a.clientX;_24._lastColumnSetTouchY=_2a.clientY;}),on(_25,_20("end"),function(){_24._currentlyTouchedColumnSet=null;})];return {remove:function(){for(var i=_27.length;i--;){_27[i].remove();}}};};};var _2c=_6("event-mousewheel")||_6("event-wheel")?function(_2d){return function(_2e,_2f){return on(_2e,_6("event-wheel")?"wheel":"mousewheel",function(_30){var _31=_1c(_30.target,_2e),_32;if(!_31){return;}_32=_30.deltaX||-_30.wheelDeltaX/3;if(_32){_2f.call(null,_2d,_31,_32);}});};}:function(_33){return function(_34,_35){return on(_34,".dgrid-column-set["+_e+"]:MozMousePixelScroll",function(_36){if(_36.axis===1){_35.call(null,_33,this,_36.detail);}});};};function _37(_38,_39,_3a){var id=_39.getAttribute(_e),_3b=_38._columnSetScrollers[id],_3c=_3b.scrollLeft+_3a;_3b.scrollLeft=_3c<0?0:_3c;};return _1(null,{postCreate:function(){var _3d=this;this.inherited(arguments);this.on(_2c(this),_37);if(_6("touch")){this.on(_23(this),_37);}this.on(".dgrid-column-set:dgrid-cellfocusin",function(_3e){_3d._onColumnSetCellFocus(_3e,this);});},columnSets:[],createRowCells:function(tag,_3f,_40,_41){var row=_3.create("table",{className:"dgrid-row-table"});var _42=_3.create("tbody",null,row);var tr=_3.create("tr",null,_42);for(var i=0,l=this.columnSets.length;i<l;i++){var _43=_3.create(tag,{className:"dgrid-column-set-cell dgrid-column-set-"+i},tr);_43=_3.create("div",{className:"dgrid-column-set"},_43);_43.setAttribute(_e,i);var _44=_13(_40||this.subRows,i)||this.columnSets[i];_43.appendChild(this.inherited(arguments,[tag,_3f,_44,_41]));}return row;},renderArray:function(){var _45=this.inherited(arguments);for(var i=0;i<_45.length;i++){_f(this,_45[i]);}return _45;},insertRow:function(){var row=this.inherited(arguments);_f(this,row);return row;},renderHeader:function(){this.inherited(arguments);var _46=this.columnSets,_47=this._columnSetScrollers,_48=this,i,l;function _49(){_48._positionScrollers();};this._columnSetScrollerContents={};this._columnSetScrollLefts={};if(_47){for(i in _47){_3.destroy(_47[i]);}}else{_4.after(this,"resize",_49,true);_4.after(this,"styleColumn",_49,true);this._columnSetScrollerNode=_3.create("div",{className:"dgrid-column-set-scroller-container"},this.footerNode,"after");}_47=this._columnSetScrollers={};for(i=0,l=_46.length;i<l;i++){this._putScroller(_46[i],i);}this._positionScrollers();},styleColumnSet:function(_4a,css){var _4b=this.addCssRule("#"+_7.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-set-"+_7.escapeCssIdentifier(_4a,"-"),css);this._positionScrollers();return _4b;},_destroyColumns:function(){var _4c=this.columnSets.length,i,j,k,_4d,len,_4e,_4f,_50;for(i=0;i<_4c;i++){_4e=this.columnSets[i];for(j=0,_4d=_4e.length;j<_4d;j++){_4f=_4e[j];for(k=0,len=_4f.length;k<len;k++){_50=_4f[k];if(typeof _50.destroy==="function"){_50.destroy();}}}}this.inherited(arguments);},configStructure:function(){this.columns={};this.subRows=[];for(var i=0,l=this.columnSets.length;i<l;i++){var _51=this.columnSets[i];for(var j=0;j<_51.length;j++){_51[j]=this._configColumns(i+"-"+j+"-",_51[j]);}}this.inherited(arguments);},_positionScrollers:function(){var _52=this.domNode,_53=this._columnSetScrollers,_54=this._columnSetScrollerContents,_55=this.columnSets,_56=0,_57=0,i,l,_58,_59;for(i=0,l=_55.length;i<l;i++){_58=_5(".dgrid-column-set["+_e+"=\""+i+"\"]",_52)[0];_56=_58.offsetWidth;_59=_58.firstChild.offsetWidth;_54[i].style.width=_59+"px";_53[i].style.width=_56+"px";if(_6("ie")<9){_53[i].style.overflowX=_59>_56?"scroll":"auto";}if(_59>_56){_57++;}}this._columnSetScrollerNode.style.bottom=this.showFooter?this.footerNode.offsetHeight+"px":"0";this.bodyNode.style.bottom=_57?(_6("dom-scrollbar-height")+(_6("ie")?1:0)+"px"):"0";},_putScroller:function(_5a,i){var _5b=this._columnSetScrollers[i]=_3.create("span",{className:"dgrid-column-set-scroller dgrid-column-set-scroller-"+i},this._columnSetScrollerNode);_5b.setAttribute(_e,i);this._columnSetScrollerContents[i]=_3.create("div",{className:"dgrid-column-set-scroller-content"},_5b);on(_5b,"scroll",_2.hitch(this,"_onColumnSetScroll"));},_onColumnSetScroll:function(evt){var _5c=evt.target.scrollLeft,_5d=evt.target.getAttribute(_e),_5e;if(this._columnSetScrollLefts[_5d]!==_5c){_5(".dgrid-column-set["+_e+"=\""+_5d+"\"], .dgrid-column-set-scroller["+_e+"=\""+_5d+"\"]",this.domNode).forEach(function(_5f,i){_5f.scrollLeft=_5c;if(!i){_5e=_5f.scrollLeft;}});this._columnSetScrollLefts[_5d]=_5e;}},_setColumnSets:function(_60){this._destroyColumns();this.columnSets=_60;this._updateColumns();},_scrollColumnSet:function(_61,_62){var id=_61.tagName?_61.getAttribute(_e):_61;var _63=this._columnSetScrollers[id];_63.scrollLeft=_62<0?0:_62;},_onColumnSetCellFocus:function(_64,_65){var _66=_64.target;var _67=_65.getAttribute(_e);var _68=this._columnSetScrollers[_67];var _69=_66.offsetLeft-_68.scrollLeft+_66.offsetWidth;if(_69>_65.offsetWidth||_68.scrollLeft>_66.offsetLeft){this._scrollColumnSet(_65,_66.offsetLeft);}}});});